<!DOCTYPE html><html lang="en"><head><!--  --><meta charset="utf-8"/><meta author="David Wilson"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="stylesheet" href="/css/bootstrap.min.css"/><link rel="stylesheet" href="/fonts/iosevka-aile/iosevka-aile.css"/><link rel="stylesheet" href="/fonts/jetbrains-mono/jetbrains-mono.css"/><link rel="stylesheet" href="/css/code.css"/><link rel="stylesheet" href="/css/site.css"/><script defer="defer" data-domain="systemcrafters.org" src="https://plausible.io/js/plausible.js"></script><title>System Crafters Live! - May 21, 2021 - System Crafters</title></head><body><div><div class="blog-header"><div class="container"><div class="row align-items-center justify-content-between"><div class="col-sm-12 col-md-8"><div class="blog-title">System Crafters</div></div><div class="col-sm col-md"><div class="blog-description text-sm-left text-md-right text-lg-right text-xl-right"></div></div></div></div></div><div class="blog-masthead"><div class="container"><div class="row align-items-center justify-content-between"><div class="col-sm-12 col-md-12"><nav class="nav"><a class="nav-link" href="/">Home</a> <a class="nav-link" href="/videos">Videos</a><a class="nav-link" href="https://wiki.systemcrafters.cc">Wiki</a> <a class="nav-link" href="/support-the-channel">Support The Channel</a></nav></div></div></div></div></div><div class="container"><div class="row"><div class="col-sm-12 blog-main"><div class="blog-post"><h1 class="blog-post-title">System Crafters Live! - May 21, 2021</h1><p class="blog-post-meta"></p><div><p><a href="https://www.youtube.com/watch?v=UtqE-lR2HCA">Watch the recording</a> on YouTube!
</p>

<h2><a id="replacing-ivy-and-counsel-with-vertico-and-consult" class="anchor" href="#replacing-ivy-and-counsel-with-vertico-and-consult">¶</a>Replacing Ivy and Counsel with Vertico and Consult</h2><p>If you tried out Vertico after the video on Monday, you probably wondered how you can get back to the level of functionality you had with Ivy.
</p>

<p>Today we're going to survey the set of commands that come with the Consult package to figure out which will be useful for the transition away from Ivy.
</p>

<p>I'll be making a video on this soon, but today we'll be figuring it out together!
</p>

<h3><a id="mapping-ivyswipercounsel-to-consult" class="anchor" href="#mapping-ivyswipercounsel-to-consult">¶</a>Mapping Ivy/Swiper/Counsel to Consult</h3><ul><li><kbd>swiper</kbd> -&gt; <kbd>consult-line</kbd></li>
<li><kbd>counsel-rg</kbd> -&gt; <kbd>consult-ripgrep</kbd></li>
<li><kbd>counsel-switch-buffer</kbd> -&gt; <kbd>consult-buffer</kbd>.  Annotations are better for <kbd>switch-to-buffer</kbd>?</li>
<li><kbd>counsel-org-goto</kbd> -&gt; <kbd>consult-imenu</kbd> or <kbd>consult-org-heading</kbd></li>
</ul>

<p><strong>TIP:</strong> You should set <kbd>consult-project-root-function</kbd> to something like this if you use Projectile:
</p>

<pre><code class="emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/get-project-root</span> ()
  (<span class="org-keyword">when</span> (fboundp 'projectile-project-root)
    (projectile-project-root)))

</code></pre>

<h3><a id="other-useful-commands" class="anchor" href="#other-useful-commands">¶</a>Other useful commands</h3><ul><li><kbd>consult-mark</kbd>: Show a list of previous mark locations</li>
<li><kbd>consult-outline</kbd>: Show a list of headings in the current file depending on type</li>
<li><kbd>consult-minor-mode-menu</kbd>: Show a list of all minor modes, press <kbd>i SPC</kbd> to narrow to active modes</li>
<li><kbd>consult-history</kbd>: History for current minibuffer, also works for terminal modes</li>
<li><kbd>consult-file-externally</kbd>: Open a file in an external program</li>
<li><kbd>consult-preview-mode</kbd>: Preview selections for various commands</li>
<li><kbd>consult-completion-in-region</kbd>: Can be used with the <kbd>completion-in-region-function</kbd> variable to do in-buffer completions using Vertico</li>
</ul>

<h3><a id="going-up-a-directory-in-kbdfind-filekbd" class="anchor" href="#going-up-a-directory-in-kbdfind-filekbd">¶</a>Going up a directory in <kbd>find-file</kbd></h3><p>One bit of functionality I got used to in Ivy was how the <kbd>counsel-find-file</kbd> command would go up a directory whenever I pressed Backspace.  Here's how to replicate it in Vertico!
</p>

<pre><code class="emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/minibuffer-backward-kill</span> (arg)
  <span class="org-doc">"When minibuffer is completing a file name delete up to parent</span>
<span class="org-doc">folder, otherwise delete a character backward"</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"p"</span>)
  (<span class="org-keyword">if</span> minibuffer-completing-file-name
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Borrowed from https://github.com/raxod502/selectrum/issues/498#issuecomment-803283608</span>
      (<span class="org-keyword">if</span> (string-match-p <span class="org-string">"/."</span> (minibuffer-contents))
          (zap-up-to-char (- arg) ?/)
        (delete-minibuffer-contents))
      (delete-backward-char arg)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">This is not a full config, just an example of the :bind!</span>
(<span class="org-keyword">use-package</span> <span class="org-constant">vertico</span>
  <span class="org-builtin">:bind</span> (<span class="org-builtin">:map</span> minibuffer-local-map
         (<span class="org-string">"&lt;backspace&gt;"</span> . dw/minibuffer-backward-kill)))

</code></pre>

<h3><a id="other-consult-packages" class="anchor" href="#other-consult-packages">¶</a>Other Consult packages</h3><ul><li><a href="https://github.com/gagbo/consult-lsp">lsp-mode interface for Consult</a></li>
<li><a href="https://github.com/SebastienWae/app-launcher">App launching like counsel-linux-app with app-launcher</a></li>
</ul>

<h3><a id="other-resources" class="anchor" href="#other-resources">¶</a>Other resources</h3><ul><li><a href="https://github.com/minad/consult/wiki">The Consult wiki</a></li>
<li><a href="https://github.com/minad/consult/issues/6">Consult command wishlist</a> - has some good pointers on where to find replacement functionality</li>
</ul>

<h2><a id="emacs-news" class="anchor" href="#emacs-news">¶</a>Emacs News</h2><ul><li><a href="https://github.com/minad/affe">New package: minad/affe</a></li>
<li><a href="https://www.reddit.com/r/emacs/comments/n9ts4j/gccemacs_prebuilt_package_on_windows_10/">Prebuilt Emacs 28 package for Windows with native compilation</a></li>
<li><a href="https://www.philnewton.net/blog/bug-reference-config-org-mode/">Configuring bug-reference-mode from within org-mode</a></li>
<li><a href="https://nyxt.atlas.engineer/article/release-2.0.0.org">Nyxt 2.0 released</a></li>
</ul>
</div></div></div></div></div><footer class="blog-footer"><div class="container"><div class="row"><div class="col-sm col-md text-sm-left text-md-right text-lg-right text-xl-right"><p>Made with Emacs 27.2 (Org mode 9.4.4)</p></div></div></div></footer><script src="/js/bootstrap.bundle.min.js"/></body></html>
